# Exercice 3.2.13 : rogue_signals

**Module :**
3.2.7 â€” Wireless Security

**Concept :**
i â€” Advanced Wireless Attack Detection (Evil Twin, Karma, WPS, Bluetooth)

**Difficulte :**
â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜† (9/10)

**Type :**
complet

**Tiers :**
2 â€” Melange (concepts i + j + k + l + m + n)

**Langage :**
Rust Edition 2024

**Prerequis :**
- 3.2.12 (Airwave Hunter)
- Understanding of wireless attack techniques
- Knowledge of Bluetooth protocols

**Domaines :**
Net, Crypto, Algo

**Duree estimee :**
7-9 heures

**XP Base :**
450

**Complexite :**
T4 O(nÂ²) Ã— S3 O(n log n)

---

## ğŸ“ SECTION 1 : PROTOTYPE & CONSIGNE

### 1.1 Obligations

**Fichier a rendre :** `rogue_signals.rs`

**Fonctions autorisees :**
- `std::collections::*`
- `serde::*`
- `chrono::*`
- Fonctions mathematiques standard

**Fonctions interdites :**
- Acces hardware wireless/bluetooth
- `std::process::Command`
- Bibliotheques reseau actives

---

### 1.2 Consigne

**ğŸ® CONTEXTE : "Blade Runner" - Replicant Detection Unit**

*"Dans les megapoles de 2049, les 'replicants' sont indiscernables des humains. Dans le spectre radio, les 'Evil Twins' sont des points d'acces malveillants indiscernables des legitimes.*

*Tu es un Blade Runner du spectre electromagnetique. Ta mission : identifier les signaux 'replicants' parmi les legitimes. Les attaques Karma repondent a toutes les requetes comme un replicant parfait. Les Evil Twins imitent les reseaux connus. Les attaques Bluetooth s'infiltrent via des protocoles oublies.*

*'I've seen things you people wouldn't believe. Attack ships on fire off the shoulder of Orion. I watched rogue APs glitter in the dark near the Tannhauser Gate.'"*

---

### 1.2.1 Contexte Academique

Les attaques wireless avancees exploitent :

1. **Evil Twin** : AP malveillant avec meme SSID que le legitime
2. **Karma/MANA** : Repond a toutes les probe requests
3. **WPS** : Vulnerabilites du Wi-Fi Protected Setup
4. **Bluetooth** : Bluesnarfing, BlueBorne, KNOB
5. **KRACK** : Key Reinstallation Attack sur WPA2
6. **FragAttacks** : Vulnerabilites de fragmentation WiFi

---

**Ta mission :**

Implementer `rogue_signals` qui:

1. **Detecte les Evil Twins** (meme SSID, MAC different, signal plus fort)
2. **Identifie les attaques Karma** (AP repondant a tous les probes)
3. **Detecte les tentatives WPS brute-force** (patterns PIN)
4. **Analyse les anomalies Bluetooth** (comportements suspects)
5. **Correle les evenements** pour construire une timeline d'attaque
6. **Calcule un score de risque** global

---

**Entree :**

```json
{
  "capture_duration_seconds": 600,
  "known_networks": [
    {
      "ssid": "CorporateWiFi",
      "bssid": "AA:BB:CC:DD:EE:FF",
      "expected_channel": 6,
      "expected_security": "WPA2-Enterprise"
    }
  ],
  "wifi_events": [
    {
      "event_id": "W001",
      "timestamp": "2026-01-10T10:00:00.000Z",
      "event_type": "beacon",
      "bssid": "AA:BB:CC:DD:EE:FF",
      "ssid": "CorporateWiFi",
      "channel": 6,
      "signal_strength": -50,
      "security": "WPA2-Enterprise",
      "vendor": "Cisco"
    },
    {
      "event_id": "W002",
      "timestamp": "2026-01-10T10:00:05.000Z",
      "event_type": "beacon",
      "bssid": "11:22:33:44:55:66",
      "ssid": "CorporateWiFi",
      "channel": 1,
      "signal_strength": -30,
      "security": "WPA2-PSK",
      "vendor": "Unknown"
    },
    {
      "event_id": "W003",
      "timestamp": "2026-01-10T10:00:10.000Z",
      "event_type": "probe_response",
      "bssid": "DE:AD:BE:EF:CA:FE",
      "ssid": "FreeWiFi",
      "probe_request_ssid": "HomeNetwork"
    }
  ],
  "bluetooth_events": [
    {
      "event_id": "B001",
      "timestamp": "2026-01-10T10:01:00.000Z",
      "event_type": "inquiry_response",
      "bd_addr": "AA:BB:CC:DD:EE:01",
      "device_name": "Employee Phone",
      "device_class": "Phone",
      "rssi": -60
    },
    {
      "event_id": "B002",
      "timestamp": "2026-01-10T10:01:05.000Z",
      "event_type": "connection_request",
      "bd_addr": "AA:BB:CC:DD:EE:01",
      "target": "11:22:33:44:55:01",
      "service": "OBEX",
      "authenticated": false
    }
  ],
  "wps_events": [
    {
      "event_id": "WPS001",
      "timestamp": "2026-01-10T10:02:00.000Z",
      "bssid": "AA:BB:CC:DD:EE:FF",
      "event_type": "wps_attempt",
      "pin_attempt": "12345670",
      "result": "failed"
    }
  ]
}
```

---

**Sortie :**

```json
{
  "attacks_detected": [
    {
      "attack_id": "ATK-001",
      "attack_type": "evil_twin",
      "severity": "critical",
      "confidence": 0.95,
      "description": "Evil Twin detected for CorporateWiFi",
      "evidence": {
        "legitimate_ap": {
          "bssid": "AA:BB:CC:DD:EE:FF",
          "channel": 6,
          "signal": -50,
          "security": "WPA2-Enterprise"
        },
        "rogue_ap": {
          "bssid": "11:22:33:44:55:66",
          "channel": 1,
          "signal": -30,
          "security": "WPA2-PSK"
        },
        "indicators": [
          "Different BSSID for same SSID",
          "Stronger signal than legitimate",
          "Security downgrade (Enterprise â†’ PSK)",
          "Different channel",
          "Unknown vendor"
        ]
      },
      "mitre_technique": "T1557.004",
      "first_seen": "2026-01-10T10:00:05.000Z"
    },
    {
      "attack_id": "ATK-002",
      "attack_type": "karma_attack",
      "severity": "high",
      "confidence": 0.88,
      "evidence": {
        "rogue_ap": "DE:AD:BE:EF:CA:FE",
        "responded_to_ssids": ["FreeWiFi", "HomeNetwork", "Starbucks"],
        "probe_mismatch_count": 15,
        "behavior": "Responding to probe requests for SSIDs it doesn't advertise"
      }
    },
    {
      "attack_id": "ATK-003",
      "attack_type": "wps_bruteforce",
      "severity": "medium",
      "evidence": {
        "target_bssid": "AA:BB:CC:DD:EE:FF",
        "attempts": 25,
        "unique_pins_tried": 25,
        "time_window_seconds": 300,
        "pattern": "Sequential PIN testing"
      }
    },
    {
      "attack_id": "ATK-004",
      "attack_type": "bluetooth_suspicious",
      "severity": "medium",
      "evidence": {
        "source_device": "AA:BB:CC:DD:EE:01",
        "suspicious_services": ["OBEX"],
        "unauthenticated_attempts": 3,
        "potential_attack": "Bluesnarfing attempt"
      }
    }
  ],
  "attack_timeline": [
    {
      "timestamp": "2026-01-10T10:00:05.000Z",
      "event": "Evil Twin AP first detected",
      "attack_id": "ATK-001"
    },
    {
      "timestamp": "2026-01-10T10:00:10.000Z",
      "event": "Karma behavior detected",
      "attack_id": "ATK-002"
    },
    {
      "timestamp": "2026-01-10T10:01:05.000Z",
      "event": "Suspicious Bluetooth activity",
      "attack_id": "ATK-004"
    },
    {
      "timestamp": "2026-01-10T10:02:00.000Z",
      "event": "WPS bruteforce started",
      "attack_id": "ATK-003"
    }
  ],
  "risk_assessment": {
    "overall_risk": "critical",
    "risk_score": 92,
    "attack_correlation": {
      "coordinated_attack_likely": true,
      "estimated_attackers": 1,
      "attack_phase": "active_exploitation"
    },
    "compromised_assets": [
      {
        "asset": "CorporateWiFi network",
        "risk": "Credential theft via Evil Twin"
      }
    ]
  },
  "recommendations": [
    {
      "priority": "immediate",
      "action": "Block rogue AP (11:22:33:44:55:66) via WIPS",
      "rationale": "Active Evil Twin attack in progress"
    },
    {
      "priority": "high",
      "action": "Disable WPS on all access points",
      "rationale": "WPS bruteforce detected"
    },
    {
      "priority": "medium",
      "action": "Review Bluetooth policies",
      "rationale": "Suspicious OBEX connection attempts"
    }
  ]
}
```

---

### 1.3 Prototype

```rust
/// Point d'entree principal
pub fn analyze_rogue_signals(input: &RogueInput) -> RogueAnalysis;

/// Detecte les Evil Twin APs
pub fn detect_evil_twin(
    wifi_events: &[WifiEvent],
    known_networks: &[KnownNetwork]
) -> Vec<EvilTwinAttack>;

/// Detecte les attaques Karma/MANA
pub fn detect_karma_attack(
    wifi_events: &[WifiEvent]
) -> Vec<KarmaAttack>;

/// Detecte les tentatives WPS bruteforce
pub fn detect_wps_bruteforce(
    wps_events: &[WpsEvent],
    threshold: u32
) -> Vec<WpsBruteforce>;

/// Analyse les evenements Bluetooth suspects
pub fn analyze_bluetooth(
    bt_events: &[BluetoothEvent]
) -> Vec<BluetoothThreat>;

/// Correle les attaques en timeline
pub fn build_attack_timeline(
    attacks: &[Attack]
) -> Vec<TimelineEvent>;

/// Calcule le score de risque
pub fn calculate_risk_score(
    attacks: &[Attack],
    correlations: &AttackCorrelation
) -> RiskAssessment;

/// Detecte les attaques coordonnees
pub fn detect_coordinated_attack(
    attacks: &[Attack],
    time_window_seconds: u64
) -> Option<CoordinatedAttack>;
```

---

## ğŸ’¡ SECTION 2 : LE SAVIEZ-VOUS ?

### 2.1 L'attaque Karma (2004)

Decouverte par Dino Dai Zovi et Shane Macaulay, l'attaque Karma exploite le fait que les appareils WiFi envoient des "probe requests" pour les reseaux connus. Un AP malveillant peut repondre a TOUTES ces requetes, pretendant etre chaque reseau que l'appareil cherche.

### 2.2 WPS Pixie Dust (2014)

L'attaque Pixie Dust exploite une faiblesse dans la generation des nonces E-S1 et E-S2 de certains routeurs. Avec seulement le M3, un attaquant peut recuperer le PIN WPS en quelques secondes au lieu des heures du bruteforce classique.

### 2.3 BlueBorne (2017)

Un ensemble de vulnerabilites Bluetooth permettant l'execution de code a distance sans appairage ni interaction utilisateur. Affectait Windows, Linux, iOS et Android - plus de 5 milliards d'appareils.

---

### 2.5 DANS LA VRAIE VIE

| Metier | Utilisation |
|--------|-------------|
| **WIPS Administrator** | Configure la detection automatique de rogue APs |
| **Red Team Operator** | Deploie des Evil Twins pour tests d'intrusion |
| **Incident Responder** | Analyse les attaques wireless en cours |
| **IoT Security** | Securise les communications Bluetooth/Zigbee |
| **Physical Security** | Detecte les devices de surveillance illegaux |

---

## ğŸ–¥ï¸ SECTION 3 : EXEMPLE D'UTILISATION

### 3.0 Session bash

```bash
$ ls
rogue_signals.rs  main.rs  captures/

$ cargo build --release

$ ./target/release/rogue_signals captures/office_scan.json
Rogue Signal Analysis Complete!

CRITICAL ALERTS:
[!] Evil Twin detected: CorporateWiFi
    - Rogue: 11:22:33:44:55:66 (signal: -30dBm)
    - Legit: AA:BB:CC:DD:EE:FF (signal: -50dBm)
    - Security downgrade detected!

[!] Karma attack active: DE:AD:BE:EF:CA:FE
    - Responding to 15 different SSIDs

Attacks Detected: 4
Risk Score: 92/100 (CRITICAL)
Coordinated Attack: LIKELY

Timeline exported to: timeline.json
```

---

## ğŸ’€ SECTION 3.1 : BONUS EXPERT (OPTIONNEL)

**Difficulte Bonus :**
ğŸ§ ğŸ§  (15/10)

**Recompense :**
XP Ã—6

### 3.1.1 Consigne Bonus

**ğŸ® "Voight-Kampff Test" - Deep Signal Analysis**

Implementer une detection avancee incluant :
- Detection des attaques KRACK (key reinstallation patterns)
- Analyse des FragAttacks (malformed fragments)
- Detection BlueBorne (L2CAP vulnerabilities)
- Machine learning lite pour la detection d'anomalies

---

## âœ…âŒ SECTION 4 : ZONE CORRECTION

### 4.1 Moulinette

| Test ID | Description | Points |
|---------|-------------|--------|
| `T01` | Detect basic Evil Twin | 15 |
| `T02` | Detect Evil Twin with security downgrade | 10 |
| `T03` | Detect Karma attack | 15 |
| `T04` | Detect WPS bruteforce | 10 |
| `T05` | Detect Bluetooth anomaly | 10 |
| `T06` | Build correct timeline | 10 |
| `T07` | Calculate risk score | 10 |
| `T08` | Detect coordinated attack | 10 |
| `T09` | Handle legitimate duplicates | 10 |

**Total : 100 points**

---

### 4.3 Solution de reference (extraits)

```rust
pub fn detect_evil_twin(
    wifi_events: &[WifiEvent],
    known_networks: &[KnownNetwork]
) -> Vec<EvilTwinAttack> {
    let mut attacks = Vec::new();
    let mut ssid_aps: HashMap<String, Vec<&WifiEvent>> = HashMap::new();

    // Group APs by SSID
    for event in wifi_events {
        if event.event_type == "beacon" {
            if let Some(ref ssid) = event.ssid {
                ssid_aps.entry(ssid.clone())
                    .or_default()
                    .push(event);
            }
        }
    }

    // Check each SSID with multiple APs
    for (ssid, aps) in &ssid_aps {
        if aps.len() < 2 {
            continue;
        }

        // Find the known/legitimate AP
        let known = known_networks.iter()
            .find(|n| &n.ssid == ssid);

        if let Some(legitimate) = known {
            for ap in aps {
                if let Some(ref bssid) = ap.bssid {
                    if bssid != &legitimate.bssid {
                        let mut indicators = Vec::new();

                        // Different BSSID
                        indicators.push("Different BSSID for same SSID".to_string());

                        // Signal strength comparison
                        let legit_signal = aps.iter()
                            .find(|a| a.bssid.as_ref() == Some(&legitimate.bssid))
                            .and_then(|a| a.signal_strength);

                        if let (Some(rogue_sig), Some(legit_sig)) = (ap.signal_strength, legit_signal) {
                            if rogue_sig > legit_sig {
                                indicators.push("Stronger signal than legitimate".to_string());
                            }
                        }

                        // Security downgrade
                        if let Some(ref sec) = ap.security {
                            if is_security_downgrade(&legitimate.expected_security, sec) {
                                indicators.push(format!(
                                    "Security downgrade ({} â†’ {})",
                                    legitimate.expected_security, sec
                                ));
                            }
                        }

                        // Channel difference
                        if let Some(ch) = ap.channel {
                            if ch != legitimate.expected_channel {
                                indicators.push("Different channel".to_string());
                            }
                        }

                        // Unknown vendor
                        if ap.vendor.as_ref().map(|v| v == "Unknown").unwrap_or(true) {
                            indicators.push("Unknown vendor".to_string());
                        }

                        let confidence = calculate_evil_twin_confidence(&indicators);

                        if confidence > 0.5 {
                            attacks.push(EvilTwinAttack {
                                attack_id: format!("ET-{}", attacks.len() + 1),
                                ssid: ssid.clone(),
                                legitimate_bssid: legitimate.bssid.clone(),
                                rogue_bssid: bssid.clone(),
                                indicators,
                                confidence,
                                first_seen: ap.timestamp.clone(),
                            });
                        }
                    }
                }
            }
        }
    }

    attacks
}

fn is_security_downgrade(expected: &str, actual: &str) -> bool {
    let security_levels = [
        ("Open", 0),
        ("WEP", 1),
        ("WPA-PSK", 2),
        ("WPA2-PSK", 3),
        ("WPA2-Enterprise", 4),
        ("WPA3-SAE", 5),
        ("WPA3-Enterprise", 6),
    ];

    let expected_level = security_levels.iter()
        .find(|(name, _)| expected.contains(name))
        .map(|(_, level)| level)
        .unwrap_or(&0);

    let actual_level = security_levels.iter()
        .find(|(name, _)| actual.contains(name))
        .map(|(_, level)| level)
        .unwrap_or(&0);

    actual_level < expected_level
}

pub fn detect_karma_attack(wifi_events: &[WifiEvent]) -> Vec<KarmaAttack> {
    let mut attacks = Vec::new();
    let mut ap_responses: HashMap<String, Vec<String>> = HashMap::new();
    let mut ap_advertised: HashMap<String, HashSet<String>> = HashMap::new();

    // Track what each AP advertises via beacons
    for event in wifi_events {
        if let Some(ref bssid) = event.bssid {
            if event.event_type == "beacon" {
                if let Some(ref ssid) = event.ssid {
                    ap_advertised.entry(bssid.clone())
                        .or_default()
                        .insert(ssid.clone());
                }
            }

            // Track probe responses
            if event.event_type == "probe_response" {
                if let Some(ref responded_ssid) = event.ssid {
                    ap_responses.entry(bssid.clone())
                        .or_default()
                        .push(responded_ssid.clone());
                }
            }
        }
    }

    // Karma detection: AP responds to SSIDs it doesn't advertise
    for (bssid, responses) in &ap_responses {
        let advertised = ap_advertised.get(bssid)
            .cloned()
            .unwrap_or_default();

        let mismatches: Vec<_> = responses.iter()
            .filter(|ssid| !advertised.contains(*ssid))
            .cloned()
            .collect();

        // If responding to 3+ SSIDs it doesn't advertise, likely Karma
        if mismatches.len() >= 3 {
            attacks.push(KarmaAttack {
                attack_id: format!("KARMA-{}", attacks.len() + 1),
                rogue_bssid: bssid.clone(),
                responded_ssids: mismatches,
                advertised_ssids: advertised.into_iter().collect(),
                confidence: calculate_karma_confidence(responses.len()),
            });
        }
    }

    attacks
}

pub fn detect_wps_bruteforce(
    wps_events: &[WpsEvent],
    threshold: u32
) -> Vec<WpsBruteforce> {
    let mut attacks = Vec::new();
    let mut bssid_attempts: HashMap<String, Vec<&WpsEvent>> = HashMap::new();

    for event in wps_events {
        bssid_attempts.entry(event.bssid.clone())
            .or_default()
            .push(event);
    }

    for (bssid, attempts) in &bssid_attempts {
        if attempts.len() as u32 >= threshold {
            let unique_pins: HashSet<_> = attempts.iter()
                .map(|a| &a.pin_attempt)
                .collect();

            let failed_count = attempts.iter()
                .filter(|a| a.result == "failed")
                .count();

            // Detect patterns
            let pattern = detect_pin_pattern(&attempts);

            attacks.push(WpsBruteforce {
                attack_id: format!("WPS-{}", attacks.len() + 1),
                target_bssid: bssid.clone(),
                total_attempts: attempts.len(),
                unique_pins: unique_pins.len(),
                failed_attempts: failed_count,
                pattern,
            });
        }
    }

    attacks
}

fn detect_pin_pattern(attempts: &[&WpsEvent]) -> String {
    // Check for sequential PINs
    let pins: Vec<u32> = attempts.iter()
        .filter_map(|a| a.pin_attempt.parse().ok())
        .collect();

    if pins.len() < 2 {
        return "insufficient_data".to_string();
    }

    // Check if sequential
    let mut sequential = true;
    for i in 1..pins.len() {
        if pins[i] != pins[i-1] + 1 && pins[i] != pins[i-1] + 10 {
            sequential = false;
            break;
        }
    }

    if sequential {
        "sequential_bruteforce".to_string()
    } else {
        "dictionary_based".to_string()
    }
}

pub fn calculate_risk_score(
    attacks: &[Attack],
    correlations: &AttackCorrelation
) -> RiskAssessment {
    let mut score = 0;

    for attack in attacks {
        score += match attack.severity {
            Severity::Critical => 30,
            Severity::High => 20,
            Severity::Medium => 10,
            Severity::Low => 5,
        };
    }

    if correlations.coordinated_attack_likely {
        score += 20;
    }

    score = score.min(100);

    let overall_risk = match score {
        0..=20 => "low",
        21..=50 => "medium",
        51..=75 => "high",
        _ => "critical",
    };

    RiskAssessment {
        overall_risk: overall_risk.to_string(),
        risk_score: score,
        attack_correlation: correlations.clone(),
    }
}
```

---

### 4.10 Solutions Mutantes

#### Mutant A : Evil Twin sans check BSSID

```rust
fn detect_evil_twin(...) {
    // BUG: Ne compare que le SSID, pas le BSSID
    for (ssid, aps) in &ssid_aps {
        if aps.len() > 1 {
            // Tout reseau avec 2+ APs est "evil twin"
            attacks.push(...);
        }
    }
}
// Pourquoi c'est faux : Ignore les deployments multi-AP legitimes
```

#### Mutant B : Karma false positive

```rust
fn detect_karma_attack(...) {
    // BUG: Detecte Karma si repond a UN seul SSID non-advertise
    if mismatches.len() >= 1 {
        attacks.push(...);
    }
}
// Pourquoi c'est faux : Peut etre un comportement normal
```

---

## ğŸ§  SECTION 5 : COMPRENDRE

### 5.3 Visualisation ASCII

```
EVIL TWIN ATTACK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Legitimate AP                          Evil Twin
(AA:BB:CC:DD:EE:FF)                    (11:22:33:44:55:66)
      â”‚                                      â”‚
      â”‚  Beacon: "CorporateWiFi"             â”‚  Beacon: "CorporateWiFi"
      â”‚  Signal: -50 dBm                     â”‚  Signal: -30 dBm â† STRONGER
      â”‚  Security: WPA2-Enterprise           â”‚  Security: WPA2-PSK â† DOWNGRADE
      â”‚  Channel: 6                          â”‚  Channel: 1
      â”‚                                      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Victim     â”‚
              â”‚   Device     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Connects to stronger signal
                     â”‚ (Evil Twin)
                     â–¼
         Credentials captured by attacker


KARMA ATTACK
â•â•â•â•â•â•â•â•â•â•â•â•

     Victim Device                    Karma AP (Evil)
          â”‚                                â”‚
          â”‚ Probe: "HomeNetwork"           â”‚
          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Response: "HomeNetwork"
          â”‚                                â”‚
          â”‚ Probe: "Starbucks"             â”‚
          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Response: "Starbucks"
          â”‚                                â”‚
          â”‚ Probe: "Office-5G"             â”‚
          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Response: "Office-5G"
          â”‚                                â”‚
          â”‚      "I am every network       â”‚
          â”‚       you've ever known!"      â”‚
          â”‚                                â”‚
          â””â”€â”€â”€â”€â”€â”€ Connects â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
                                           â”‚
                                    Attacker has MitM


WPS PIN BRUTEFORCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PIN Structure: XXXX-XXXY (8 digits, Y = checksum)

First half:  XXXX (10,000 possibilities)
Second half: XXX  (1,000 possibilities)
                   â†“
           Total: 11,000 attempts
                 (not 100,000,000!)

Timeline:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10:00:00 â”‚ PIN: 00000000 â”‚ FAIL â”‚                   â”‚
â”‚ 10:00:05 â”‚ PIN: 00000001 â”‚ FAIL â”‚ Sequential        â”‚
â”‚ 10:00:10 â”‚ PIN: 00000002 â”‚ FAIL â”‚ Bruteforce        â”‚
â”‚ ...      â”‚ ...           â”‚ FAIL â”‚ Detected!         â”‚
â”‚ 10:05:00 â”‚ PIN: 12345670 â”‚ FAIL â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Detection: >5 attempts in 5 minutes = Bruteforce
```

### 5.8 Mnemotechniques

#### ğŸ¬ MEME : "Blade Runner" - Voight-Kampff Test

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  "Is this AP legitimate, or is it a replicant?"                 â”‚
â”‚                                                                 â”‚
â”‚  ğŸ” VOIGHT-KAMPFF = Evil Twin Detection                         â”‚
â”‚     â†’ Test les reactions (BSSID, signal, security)              â”‚
â”‚     â†’ Les replicants (rogue APs) echouent au test               â”‚
â”‚                                                                 â”‚
â”‚  ğŸ­ KARMA = "More human than human"                             â”‚
â”‚     â†’ Pretend etre chaque reseau que tu connais                 â”‚
â”‚     â†’ Le replicant parfait                                      â”‚
â”‚     â†’ Detection: Trop parfait pour etre vrai                    â”‚
â”‚                                                                 â”‚
â”‚  ğŸ’¥ WPS = "Retirement"                                          â”‚
â”‚     â†’ Bruteforce = chercher la faille du replicant              â”‚
â”‚     â†’ 11,000 tentatives max                                     â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“¡ BLUETOOTH = "Off-world colonies"                            â”‚
â”‚     â†’ Protocoles oublies, vulnerabilites cachees                â”‚
â”‚     â†’ BlueBorne = menace invisible                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ SECTION 7 : QCM (extraits)

### Q1. Comment detecter un Evil Twin ?

- A) Signal plus faible
- B) Meme BSSID
- C) Meme SSID, BSSID different, signal plus fort
- D) SSID cache

**Reponse : C**

### Q2. Qu'est-ce qui caracterise une attaque Karma ?

- A) L'AP ne repond a aucun probe
- B) L'AP repond a tous les probes, meme pour des SSIDs qu'il n'advertise pas
- C) L'AP change de canal
- D) L'AP desactive WPA

**Reponse : B**

---

## ğŸ“¦ SECTION 9 : DEPLOYMENT PACK

```json
{
  "deploy": {
    "hackbrain_version": "5.5.2",
    "exercise_slug": "3.2.7-i-rogue-signals",
    "metadata": {
      "exercise_id": "3.2.13",
      "exercise_name": "rogue_signals",
      "module": "3.2.7",
      "module_name": "Wireless Security",
      "difficulty": 9,
      "language": "rust",
      "xp_base": 450,
      "tags": ["evil-twin", "karma", "wps", "bluetooth", "rogue-ap", "wireless-attacks"]
    }
  }
}
```

---

*HACKBRAIN v5.5.2 â€” Rogue Signals*
*"I've seen things you people wouldn't believe..."*
