# Exercice 3.5.4-a : ethics_guardian

**Module :**
3.5 ‚Äî Reverse Engineering

**Concept :**
a ‚Äî √âthique et Cadre L√©gal du Reverse Engineering

**Difficult√© :**
‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ (6/10)

**Type :**
cours_qcm

**Tiers :**
1 ‚Äî Concept isol√©

**Langage :**
Th√©orique (avec exemples en Rust Edition 2024)

**Pr√©requis :**
- Exercices 3.5.1 √† 3.5.3
- Compr√©hension g√©n√©rale du reverse engineering
- Notions de base en droit informatique

**Domaines :**
Crypto, FS, Process

**Dur√©e estim√©e :**
90 min

**XP Base :**
300

**Complexit√© :**
T1 O(1) √ó S1 O(1)

---

## üìê SECTION 1 : PROTOTYPE & CONSIGNE

### 1.1 Obligations

**Fichier √† rendre :**
`ethics_guardian.rs`

**Fonctions autoris√©es :**
- `serde_json` pour parsing JSON
- `std::collections::HashMap`
- Toute fonction de manipulation de strings

**Fonctions interdites :**
- Acc√®s r√©seau
- Acc√®s filesystem direct

### 1.2 Consigne

#### üéÆ CONTEXTE FUN ‚Äî "The Good Place" meets "Black Mirror"

**"Welcome! Everything is fine."** ‚Äî Dans *The Good Place*, Michael calcule des points √©thiques pour chaque action humaine. Dans *Black Mirror* (√©pisode "Nosedive"), un syst√®me de notation sociale dicte les comportements acceptables.

Tu es le **Ethics Guardian** ‚Äî un syst√®me d'√©valuation √©thique pour le reverse engineering. Chaque action a des cons√©quences. Chaque choix compte. Ta mission : analyser des sc√©narios de reverse engineering et d√©terminer leur l√©galit√© et √©thique.

**"There's no such thing as a neutral action."** ‚Äî M√™me lire du code d√©sassembl√© est un choix avec des implications l√©gales.

**Ta mission :**

√âcrire une fonction `ethics_guardian` qui analyse un sc√©nario de reverse engineering et retourne une √©valuation compl√®te de sa l√©galit√© et de son √©thique.

**Entr√©e :**
- `scenario_json` : JSON contenant :
  - `action` : Type d'action ("disassemble", "decompile", "patch", "keygen", "interop", "security_research", "malware_analysis")
  - `target` : Type de cible ("proprietary_software", "open_source", "own_software", "malware", "firmware", "game")
  - `purpose` : But ("learning", "interoperability", "security", "piracy", "competition", "personal_use")
  - `jurisdiction` : Pays ("US", "EU", "FR", "JP", "CN", "AU")
  - `has_eula` : Boolean - EULA pr√©sent
  - `eula_forbids_re` : Boolean - EULA interdit le RE
  - `is_drm_protected` : Boolean - Protection DRM
  - `is_published` : Boolean - R√©sultats publi√©s
  - `commercial_use` : Boolean - Usage commercial

**Sortie :**
- JSON contenant :
  - `legality_score` : Score de l√©galit√© (0-100)
  - `ethics_score` : Score √©thique (0-100)
  - `overall_verdict` : "LEGAL", "GRAY_ZONE", "ILLEGAL", "DEPENDS"
  - `applicable_laws` : Liste des lois applicables
  - `risks` : Liste des risques encourus
  - `recommendations` : Recommandations
  - `precedents` : Cas juridiques pertinents
  - `reasoning` : Explication d√©taill√©e

#### 1.2.2 Consigne Acad√©mique

Impl√©menter un syst√®me d'√©valuation √©thique et l√©gale pour le reverse engineering. Le syst√®me doit analyser un sc√©nario donn√© selon la juridiction, le type d'action, la cible, et le but, puis retourner une √©valuation structur√©e incluant les lois applicables, les risques, et des recommandations.

### 1.3 Prototype

```rust
use serde::{Deserialize, Serialize};
use std::collections::HashMap;

#[derive(Debug, Serialize, Deserialize)]
pub struct Scenario {
    pub action: String,
    pub target: String,
    pub purpose: String,
    pub jurisdiction: String,
    pub has_eula: bool,
    pub eula_forbids_re: bool,
    pub is_drm_protected: bool,
    pub is_published: bool,
    pub commercial_use: bool,
}

#[derive(Debug, Serialize, Deserialize)]
pub struct EthicsEvaluation {
    pub legality_score: u8,
    pub ethics_score: u8,
    pub overall_verdict: String,
    pub applicable_laws: Vec<String>,
    pub risks: Vec<String>,
    pub recommendations: Vec<String>,
    pub precedents: Vec<String>,
    pub reasoning: String,
}

pub fn ethics_guardian(scenario_json: &str) -> Result<String, String>;
```

---

## üí° SECTION 2 : LE SAVIEZ-VOUS ?

### 2.1 La L√©galit√© du Reverse Engineering Varie √ânorm√©ment

Le reverse engineering est :
- **Explicitement l√©gal** pour l'interop√©rabilit√© dans l'UE (Directive 2009/24/CE)
- **Souvent l√©gal** aux USA sous le "fair use" (DMCA ¬ß1201(f))
- **Tr√®s restreint** au Japon sauf exceptions sp√©cifiques
- **Quasi-interdit** en Chine pour les logiciels commerciaux

### 2.2 Des Cas C√©l√®bres ont Fa√ßonn√© le Droit

| Cas | Ann√©e | Impact |
|-----|-------|--------|
| Sony v. Connectix | 2000 | RE l√©gal pour √©mulation |
| Sega v. Accolade | 1992 | RE l√©gal pour interop√©rabilit√© |
| Oracle v. Google | 2021 | APIs non-prot√©geables |
| DMCA Exemptions | 2021 | Exceptions pour recherche s√©curit√© |

### 2.3 L'√âthique ‚â† La L√©galit√©

- **L√©gal mais non-√©thique** : Reverse engineering d'un concurrent pour copier ses fonctionnalit√©s
- **Ill√©gal mais √©thique** : Contourner le DRM d'un logiciel abandonn√© pour pr√©servation
- **L√©gal et √©thique** : Analyse de malware pour protection
- **Ill√©gal et non-√©thique** : Cr√©ation de keygens pour piratage

---

## 2.5 DANS LA VRAIE VIE

### Qui utilise ces connaissances ?

| M√©tier | Cas d'usage |
|--------|-------------|
| **Juriste Tech** | Conseiller les entreprises sur les limites l√©gales du RE |
| **Security Researcher** | Naviguer les exemptions DMCA pour vuln√©rabilit√©s |
| **Compliance Officer** | S'assurer que les √©quipes respectent les licences |
| **CTF Organizer** | Structurer des challenges l√©galement |
| **Malware Analyst** | Documenter le cadre l√©gal des analyses |

---

## üñ•Ô∏è SECTION 3 : EXEMPLE D'UTILISATION

### 3.0 Session bash

```bash
$ ls
ethics_guardian.rs  main.rs

$ cargo build --release

$ ./target/release/test
Test 1 (Interop EU): LEGAL - Score 95/100
Test 2 (Piracy US): ILLEGAL - Score 5/100
Test 3 (Malware Analysis): LEGAL - Score 100/100
Test 4 (Game modding): GRAY_ZONE - Score 60/100
Tous les tests passent!
```

### 3.1 ‚ö° BONUS STANDARD (OPTIONNEL)

**Difficult√© Bonus :**
‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ (7/10)

**R√©compense :**
XP √ó2

**Ta mission bonus :**
Impl√©menter un syst√®me de "Ethics Tribunal" qui simule un d√©bat contradictoire entre plusieurs perspectives (corporate, hacker, l√©galiste, √©thicien) et g√©n√®re un verdict pond√©r√©.

---

## ‚úÖ‚ùå SECTION 4 : ZONE CORRECTION

### 4.1 Moulinette

| Test | Input | Expected | Points |
|------|-------|----------|--------|
| `interop_eu` | action=decompile, target=proprietary, purpose=interoperability, jurisdiction=EU | LEGAL (85+) | 10 |
| `piracy_us` | action=keygen, target=proprietary, purpose=piracy, jurisdiction=US | ILLEGAL (<20) | 10 |
| `malware_fr` | action=disassemble, target=malware, purpose=security, jurisdiction=FR | LEGAL (90+) | 10 |
| `drm_bypass` | action=patch, is_drm_protected=true, purpose=personal_use, jurisdiction=US | GRAY_ZONE | 10 |
| `game_mod` | action=patch, target=game, purpose=personal_use, jurisdiction=EU | DEPENDS | 10 |
| `security_research` | action=decompile, purpose=security, is_published=true, jurisdiction=US | LEGAL | 15 |
| `commercial_re` | action=decompile, commercial_use=true, jurisdiction=JP | ILLEGAL | 15 |
| `abandoned_software` | action=patch, target=proprietary, purpose=preservation | GRAY_ZONE | 10 |
| `own_software` | action=decompile, target=own_software, any_jurisdiction | LEGAL (100) | 10 |

### 4.2 main.rs de test

```rust
use ethics_guardian::{ethics_guardian, Scenario};

fn main() {
    // Test 1: Interop√©rabilit√© EU
    let scenario1 = r#"{
        "action": "decompile",
        "target": "proprietary_software",
        "purpose": "interoperability",
        "jurisdiction": "EU",
        "has_eula": true,
        "eula_forbids_re": true,
        "is_drm_protected": false,
        "is_published": false,
        "commercial_use": false
    }"#;

    let result1 = ethics_guardian(scenario1).unwrap();
    let eval1: serde_json::Value = serde_json::from_str(&result1).unwrap();
    assert!(eval1["legality_score"].as_u64().unwrap() >= 85);
    assert_eq!(eval1["overall_verdict"], "LEGAL");
    println!("Test 1 (Interop EU): PASS");

    // Test 2: Piratage US
    let scenario2 = r#"{
        "action": "keygen",
        "target": "proprietary_software",
        "purpose": "piracy",
        "jurisdiction": "US",
        "has_eula": true,
        "eula_forbids_re": true,
        "is_drm_protected": true,
        "is_published": true,
        "commercial_use": true
    }"#;

    let result2 = ethics_guardian(scenario2).unwrap();
    let eval2: serde_json::Value = serde_json::from_str(&result2).unwrap();
    assert!(eval2["legality_score"].as_u64().unwrap() < 20);
    assert_eq!(eval2["overall_verdict"], "ILLEGAL");
    println!("Test 2 (Piracy US): PASS");

    // Test 3: Analyse Malware
    let scenario3 = r#"{
        "action": "disassemble",
        "target": "malware",
        "purpose": "security",
        "jurisdiction": "FR",
        "has_eula": false,
        "eula_forbids_re": false,
        "is_drm_protected": false,
        "is_published": true,
        "commercial_use": false
    }"#;

    let result3 = ethics_guardian(scenario3).unwrap();
    let eval3: serde_json::Value = serde_json::from_str(&result3).unwrap();
    assert!(eval3["legality_score"].as_u64().unwrap() >= 90);
    println!("Test 3 (Malware Analysis): PASS");

    println!("\nTous les tests passent!");
}
```

### 4.3 Solution de r√©f√©rence

```rust
use serde::{Deserialize, Serialize};
use std::collections::HashMap;

#[derive(Debug, Serialize, Deserialize)]
pub struct Scenario {
    pub action: String,
    pub target: String,
    pub purpose: String,
    pub jurisdiction: String,
    pub has_eula: bool,
    pub eula_forbids_re: bool,
    pub is_drm_protected: bool,
    pub is_published: bool,
    pub commercial_use: bool,
}

#[derive(Debug, Serialize, Deserialize)]
pub struct EthicsEvaluation {
    pub legality_score: u8,
    pub ethics_score: u8,
    pub overall_verdict: String,
    pub applicable_laws: Vec<String>,
    pub risks: Vec<String>,
    pub recommendations: Vec<String>,
    pub precedents: Vec<String>,
    pub reasoning: String,
}

pub fn ethics_guardian(scenario_json: &str) -> Result<String, String> {
    let scenario: Scenario = serde_json::from_str(scenario_json)
        .map_err(|e| format!("Invalid JSON: {}", e))?;

    let mut legality_score: i32 = 50;
    let mut ethics_score: i32 = 50;
    let mut applicable_laws = Vec::new();
    let mut risks = Vec::new();
    let mut recommendations = Vec::new();
    let mut precedents = Vec::new();
    let mut reasoning_parts = Vec::new();

    // === Analyse par cible ===
    match scenario.target.as_str() {
        "own_software" => {
            legality_score += 50;
            ethics_score += 50;
            reasoning_parts.push("Analyzing your own software is always legal.".to_string());
        }
        "malware" => {
            legality_score += 40;
            ethics_score += 40;
            reasoning_parts.push("Malware analysis is generally protected for security research.".to_string());
            precedents.push("Most jurisdictions exempt security research".to_string());
        }
        "open_source" => {
            legality_score += 30;
            ethics_score += 20;
            reasoning_parts.push("Open source software generally permits analysis per license.".to_string());
        }
        "proprietary_software" => {
            legality_score -= 10;
            reasoning_parts.push("Proprietary software requires careful legal consideration.".to_string());
        }
        "game" => {
            reasoning_parts.push("Game modding exists in a complex legal gray zone.".to_string());
        }
        _ => {}
    }

    // === Analyse par action ===
    match scenario.action.as_str() {
        "disassemble" => {
            reasoning_parts.push("Disassembly is the least invasive form of RE.".to_string());
        }
        "decompile" => {
            legality_score -= 5;
            reasoning_parts.push("Decompilation creates more readable representations.".to_string());
        }
        "patch" => {
            legality_score -= 15;
            ethics_score -= 10;
            risks.push("Patching may violate EULA terms".to_string());
        }
        "keygen" => {
            legality_score -= 40;
            ethics_score -= 40;
            risks.push("Keygen creation is illegal in most jurisdictions".to_string());
            applicable_laws.push("DMCA ¬ß1201 (US)".to_string());
            applicable_laws.push("EUCD Art. 6 (EU)".to_string());
        }
        _ => {}
    }

    // === Analyse par but ===
    match scenario.purpose.as_str() {
        "interoperability" => {
            legality_score += 30;
            ethics_score += 25;
            reasoning_parts.push("Interoperability is a protected purpose in most jurisdictions.".to_string());
            precedents.push("Sega v. Accolade (1992)".to_string());
            precedents.push("Sony v. Connectix (2000)".to_string());
        }
        "security" => {
            legality_score += 35;
            ethics_score += 35;
            reasoning_parts.push("Security research benefits from specific exemptions.".to_string());
            precedents.push("DMCA Security Research Exemption (2021)".to_string());
        }
        "learning" => {
            legality_score += 15;
            ethics_score += 20;
            reasoning_parts.push("Educational purposes are often protected.".to_string());
        }
        "piracy" => {
            legality_score -= 50;
            ethics_score -= 50;
            risks.push("Criminal prosecution possible".to_string());
            risks.push("Civil liability for damages".to_string());
        }
        "competition" => {
            legality_score -= 20;
            ethics_score -= 15;
            risks.push("Trade secret misappropriation claims".to_string());
        }
        "personal_use" => {
            ethics_score += 10;
            reasoning_parts.push("Personal use without distribution is less risky.".to_string());
        }
        _ => {}
    }

    // === Analyse par juridiction ===
    match scenario.jurisdiction.as_str() {
        "EU" | "FR" => {
            applicable_laws.push("Directive 2009/24/CE (Software Directive)".to_string());
            applicable_laws.push("Art. L122-6-1 CPI (France)".to_string());
            if scenario.purpose == "interoperability" {
                legality_score += 20;
                reasoning_parts.push("EU explicitly protects RE for interoperability.".to_string());
            }
        }
        "US" => {
            applicable_laws.push("DMCA ¬ß1201".to_string());
            applicable_laws.push("Copyright Act ¬ß107 (Fair Use)".to_string());
            if scenario.is_drm_protected {
                legality_score -= 20;
                risks.push("DMCA anti-circumvention provisions apply".to_string());
            }
        }
        "JP" => {
            applicable_laws.push("Copyright Act of Japan".to_string());
            applicable_laws.push("Unfair Competition Prevention Act".to_string());
            legality_score -= 15;
            reasoning_parts.push("Japan has restrictive RE laws.".to_string());
        }
        "CN" => {
            applicable_laws.push("PRC Copyright Law".to_string());
            legality_score -= 20;
            reasoning_parts.push("China restricts most commercial software RE.".to_string());
        }
        "AU" => {
            applicable_laws.push("Copyright Act 1968".to_string());
            applicable_laws.push("Digital Agenda Act 2000".to_string());
        }
        _ => {}
    }

    // === Facteurs aggravants/att√©nuants ===
    if scenario.has_eula && scenario.eula_forbids_re {
        legality_score -= 10;
        risks.push("EULA violation - breach of contract risk".to_string());
        recommendations.push("Review if EULA terms are enforceable in your jurisdiction".to_string());
    }

    if scenario.is_drm_protected {
        legality_score -= 15;
        risks.push("Anti-circumvention laws may apply".to_string());
    }

    if scenario.is_published {
        if scenario.purpose == "security" {
            ethics_score += 10;
            recommendations.push("Follow responsible disclosure practices".to_string());
        } else {
            legality_score -= 10;
            risks.push("Publication increases legal exposure".to_string());
        }
    }

    if scenario.commercial_use {
        legality_score -= 20;
        ethics_score -= 15;
        risks.push("Commercial use significantly increases legal risk".to_string());
    }

    // === Calcul final ===
    legality_score = legality_score.clamp(0, 100);
    ethics_score = ethics_score.clamp(0, 100);

    let overall_verdict = if legality_score >= 80 {
        "LEGAL".to_string()
    } else if legality_score >= 50 {
        "GRAY_ZONE".to_string()
    } else if legality_score >= 30 {
        "DEPENDS".to_string()
    } else {
        "ILLEGAL".to_string()
    };

    // Recommendations g√©n√©rales
    if recommendations.is_empty() {
        recommendations.push("Consult with legal counsel before proceeding".to_string());
        recommendations.push("Document your purpose and methodology".to_string());
    }

    let evaluation = EthicsEvaluation {
        legality_score: legality_score as u8,
        ethics_score: ethics_score as u8,
        overall_verdict,
        applicable_laws,
        risks,
        recommendations,
        precedents,
        reasoning: reasoning_parts.join(" "),
    };

    serde_json::to_string_pretty(&evaluation)
        .map_err(|e| format!("Serialization error: {}", e))
}
```

### 4.4 Solutions alternatives accept√©es

```rust
// Alternative 1: Approche avec syst√®me de r√®gles
pub fn ethics_guardian_rules(scenario_json: &str) -> Result<String, String> {
    // Utilisation d'un syst√®me de r√®gles d√©claratives
    // au lieu de match imbriqu√©s
    let rules: Vec<Rule> = vec![
        Rule::new("own_software", 50, 50),
        Rule::new("malware+security", 40, 40),
        // ... etc
    ];
    // Application des r√®gles
}

// Alternative 2: Approche avec matrice de d√©cision
pub fn ethics_guardian_matrix(scenario_json: &str) -> Result<String, String> {
    // Matrice [action][target][purpose][jurisdiction]
    // Lookup direct dans une table pr√©calcul√©e
}
```

### 4.5 Solutions refus√©es

```rust
// REFUS√â: Toujours retourner LEGAL
pub fn ethics_guardian_naive(scenario_json: &str) -> Result<String, String> {
    Ok(r#"{"overall_verdict": "LEGAL", "legality_score": 100}"#.to_string())
}
// Pourquoi: Ne fait aucune analyse r√©elle

// REFUS√â: Ignorer la juridiction
pub fn ethics_guardian_no_jurisdiction(scenario_json: &str) -> Result<String, String> {
    // Analyse sans tenir compte du pays
    // La juridiction est CRUCIALE en RE
}
// Pourquoi: La l√©galit√© varie √©norm√©ment selon le pays
```

### 4.9 spec.json

```json
{
  "name": "ethics_guardian",
  "language": "rust",
  "type": "cours_qcm",
  "tier": 1,
  "tier_info": "Concept isol√©",
  "tags": ["ethics", "legal", "reverse-engineering", "phase3"],
  "passing_score": 70,

  "function": {
    "name": "ethics_guardian",
    "prototype": "pub fn ethics_guardian(scenario_json: &str) -> Result<String, String>",
    "return_type": "Result<String, String>",
    "parameters": [
      {"name": "scenario_json", "type": "&str"}
    ]
  },

  "driver": {
    "reference": "pub fn ref_ethics_guardian(scenario_json: &str) -> Result<String, String> { let s: Scenario = serde_json::from_str(scenario_json)?; let mut score = 50i32; match s.target.as_str() { \"own_software\" => score += 50, \"malware\" => score += 40, _ => {} } match s.purpose.as_str() { \"interoperability\" | \"security\" => score += 30, \"piracy\" => score -= 50, _ => {} } if s.action == \"keygen\" { score -= 40; } let verdict = if score >= 80 { \"LEGAL\" } else if score >= 50 { \"GRAY_ZONE\" } else if score < 30 { \"ILLEGAL\" } else { \"DEPENDS\" }; Ok(format!(r#\"{{\"legality_score\": {}, \"overall_verdict\": \"{}\"}}\"#, score.clamp(0,100), verdict)) }",

    "edge_cases": [
      {
        "name": "own_software_always_legal",
        "args": ["{\"action\":\"decompile\",\"target\":\"own_software\",\"purpose\":\"learning\",\"jurisdiction\":\"US\",\"has_eula\":false,\"eula_forbids_re\":false,\"is_drm_protected\":false,\"is_published\":false,\"commercial_use\":false}"],
        "expected_contains": "LEGAL",
        "is_trap": false
      },
      {
        "name": "piracy_always_illegal",
        "args": ["{\"action\":\"keygen\",\"target\":\"proprietary_software\",\"purpose\":\"piracy\",\"jurisdiction\":\"US\",\"has_eula\":true,\"eula_forbids_re\":true,\"is_drm_protected\":true,\"is_published\":true,\"commercial_use\":true}"],
        "expected_contains": "ILLEGAL",
        "is_trap": true,
        "trap_explanation": "Keygens for piracy are illegal everywhere"
      },
      {
        "name": "interop_eu_protected",
        "args": ["{\"action\":\"decompile\",\"target\":\"proprietary_software\",\"purpose\":\"interoperability\",\"jurisdiction\":\"EU\",\"has_eula\":true,\"eula_forbids_re\":true,\"is_drm_protected\":false,\"is_published\":false,\"commercial_use\":false}"],
        "expected_contains": "LEGAL",
        "is_trap": false
      },
      {
        "name": "malware_analysis_legal",
        "args": ["{\"action\":\"disassemble\",\"target\":\"malware\",\"purpose\":\"security\",\"jurisdiction\":\"FR\",\"has_eula\":false,\"eula_forbids_re\":false,\"is_drm_protected\":false,\"is_published\":true,\"commercial_use\":false}"],
        "expected_contains": "LEGAL",
        "is_trap": false
      }
    ]
  },

  "norm": {
    "allowed_functions": ["serde_json::from_str", "serde_json::to_string"],
    "forbidden_functions": ["std::fs", "std::net"],
    "check_security": true,
    "check_memory": true,
    "blocking": true
  }
}
```

### 4.10 Solutions Mutantes

```rust
/* Mutant A (Boundary) : Score mal clamp√© */
pub fn ethics_guardian_mutant_a(scenario_json: &str) -> Result<String, String> {
    // ... m√™me code mais ...
    legality_score = legality_score.clamp(0, 110); // Bug: max 110 au lieu de 100
    // ...
}
// Pourquoi c'est faux: Score peut d√©passer 100%

/* Mutant B (Safety) : Pas de validation JSON */
pub fn ethics_guardian_mutant_b(scenario_json: &str) -> Result<String, String> {
    let scenario: Scenario = serde_json::from_str(scenario_json).unwrap(); // Bug: unwrap
    // ...
}
// Pourquoi c'est faux: Panic sur JSON invalide

/* Mutant C (Logic) : Juridiction ignor√©e pour DRM */
pub fn ethics_guardian_mutant_c(scenario_json: &str) -> Result<String, String> {
    // ... analyse normale mais ...
    // Oublie que le DRM n'a pas le m√™me impact selon le pays
    if scenario.is_drm_protected {
        legality_score -= 30; // M√™me p√©nalit√© partout
    }
    // ...
}
// Pourquoi c'est faux: US DMCA tr√®s strict, EU plus souple

/* Mutant D (Logic) : Purpose ignor√© pour keygens */
pub fn ethics_guardian_mutant_d(scenario_json: &str) -> Result<String, String> {
    // Keygen toujours -40 m√™me si but = "security_research"
    // Un keygen cr√©√© pour d√©montrer une faille != piratage
}
// Pourquoi c'est faux: Context matters

/* Mutant E (Return) : Toujours GRAY_ZONE */
pub fn ethics_guardian_mutant_e(scenario_json: &str) -> Result<String, String> {
    // ... calculs corrects mais ...
    Ok(format!(r#"{{"overall_verdict": "GRAY_ZONE", "legality_score": {}}}"#, legality_score))
}
// Pourquoi c'est faux: √âvite de trancher m√™me quand c'est clair
```

---

## üß† SECTION 5 : COMPRENDRE

### 5.1 Ce que cet exercice enseigne

1. **Cadre l√©gal international** du reverse engineering
2. **Diff√©rences juridictionnelles** (US, EU, JP, etc.)
3. **Exceptions l√©gales** (interop√©rabilit√©, s√©curit√©, fair use)
4. **Distinction l√©galit√© vs √©thique**
5. **√âvaluation de risques** pour les actions de RE

### 5.2 LDA ‚Äî Traduction Litt√©rale

```
FONCTION ethics_guardian QUI RETOURNE UN R√âSULTAT CONTENANT UNE CHA√éNE OU UNE ERREUR ET PREND EN PARAM√àTRE scenario_json QUI EST UNE R√âF√âRENCE VERS UNE CHA√éNE
D√âBUT FONCTION
    D√âCLARER scenario COMME R√âSULTAT DU PARSING JSON DE scenario_json
    SI scenario EST UNE ERREUR ALORS
        RETOURNER L'ERREUR "JSON invalide"
    FIN SI

    D√âCLARER legality_score COMME ENTIER INITIALIS√â √Ä 50
    D√âCLARER ethics_score COMME ENTIER INITIALIS√â √Ä 50

    SELON LA CIBLE DE scenario FAIRE
        CAS "own_software":
            AJOUTER 50 √Ä legality_score
            AJOUTER 50 √Ä ethics_score
        CAS "malware":
            AJOUTER 40 √Ä legality_score
        CAS "proprietary_software":
            SOUSTRAIRE 10 DE legality_score
    FIN SELON

    SELON LE BUT DE scenario FAIRE
        CAS "interoperability":
            AJOUTER 30 √Ä legality_score
        CAS "security":
            AJOUTER 35 √Ä legality_score
        CAS "piracy":
            SOUSTRAIRE 50 DE legality_score
    FIN SELON

    SI legality_score EST SUP√âRIEUR OU √âGAL √Ä 80 ALORS
        AFFECTER "LEGAL" AU VERDICT
    SINON SI legality_score EST SUP√âRIEUR OU √âGAL √Ä 50 ALORS
        AFFECTER "GRAY_ZONE" AU VERDICT
    SINON
        AFFECTER "ILLEGAL" AU VERDICT
    FIN SI

    RETOURNER L'√âVALUATION S√âRIALIS√âE EN JSON
FIN FONCTION
```

### 5.3 Visualisation ASCII

```
                    MATRICE D'√âVALUATION √âTHIQUE

    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                    L√âGALIT√â                              ‚îÇ
    ‚îÇ         L√âGAL          GRAY         ILLEGAL              ‚îÇ
    ‚îÇ           ‚îÇ              ‚îÇ              ‚îÇ                ‚îÇ
 √â  ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
 T  ‚îÇ    ‚îÇ Interop EU ‚îÇ ‚îÇ Modding ‚îÇ ‚îÇ  Piracy      ‚îÇ         ‚îÇ
 H  ‚îÇ    ‚îÇ Malware    ‚îÇ ‚îÇ Patching‚îÇ ‚îÇ  Keygens     ‚îÇ         ‚îÇ
 I  ‚îÇ B  ‚îÇ Analysis   ‚îÇ ‚îÇ Personal‚îÇ ‚îÇ  Commercial  ‚îÇ         ‚îÇ
 Q  ‚îÇ O  ‚îÇ Own Code   ‚îÇ ‚îÇ Use     ‚îÇ ‚îÇ  RE          ‚îÇ         ‚îÇ
 U  ‚îÇ N  ‚îÇ Security   ‚îÇ ‚îÇ         ‚îÇ ‚îÇ              ‚îÇ         ‚îÇ
 E  ‚îÇ    ‚îÇ Research   ‚îÇ ‚îÇ         ‚îÇ ‚îÇ              ‚îÇ         ‚îÇ
    ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
    ‚îÇ                                                          ‚îÇ
    ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
    ‚îÇ M  ‚îÇ Competitive‚îÇ ‚îÇ Bypass  ‚îÇ ‚îÇ   Most       ‚îÇ         ‚îÇ
    ‚îÇ A  ‚îÇ Intel      ‚îÇ ‚îÇ DRM for ‚îÇ ‚îÇ   Actions    ‚îÇ         ‚îÇ
    ‚îÇ U  ‚îÇ (Legal but ‚îÇ ‚îÇ Abandon-‚îÇ ‚îÇ   Explicitly ‚îÇ         ‚îÇ
    ‚îÇ V  ‚îÇ  sketchy)  ‚îÇ ‚îÇ ware    ‚îÇ ‚îÇ   Prohibited ‚îÇ         ‚îÇ
    ‚îÇ A  ‚îÇ            ‚îÇ ‚îÇ         ‚îÇ ‚îÇ              ‚îÇ         ‚îÇ
    ‚îÇ I  ‚îÇ            ‚îÇ ‚îÇ         ‚îÇ ‚îÇ              ‚îÇ         ‚îÇ
    ‚îÇ S  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


         FLUX DE D√âCISION PAR JURIDICTION

    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ    US    ‚îÇ     ‚îÇ    EU    ‚îÇ     ‚îÇ    JP    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                ‚îÇ                ‚îÇ
         ‚ñº                ‚ñº                ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  DMCA   ‚îÇ      ‚îÇDirective‚îÇ      ‚îÇCopyright‚îÇ
    ‚îÇ ¬ß1201   ‚îÇ      ‚îÇ2009/24  ‚îÇ      ‚îÇAct Japan‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                ‚îÇ                ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ DRM     ‚îÇ      ‚îÇ Interop ‚îÇ      ‚îÇ Tr√®s    ‚îÇ
    ‚îÇ Strict  ‚îÇ      ‚îÇ Exempt  ‚îÇ      ‚îÇRestrictif‚îÇ
    ‚îÇ         ‚îÇ      ‚îÇ         ‚îÇ      ‚îÇ         ‚îÇ
    ‚îÇ Fair Use‚îÇ      ‚îÇSecurity ‚îÇ      ‚îÇExceptions‚îÇ
    ‚îÇ Possible‚îÇ      ‚îÇResearch ‚îÇ      ‚îÇ Rares   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.4 Les Pi√®ges en D√©tail

#### Pi√®ge 1 : "Le EULA dit non, donc c'est ill√©gal"
**FAUX** ‚Äî En UE, un EULA ne peut pas interdire ce que la loi autorise (interop√©rabilit√©)

#### Pi√®ge 2 : "C'est pour un usage personnel, donc c'est OK"
**PARTIELLEMENT FAUX** ‚Äî L'usage personnel n'est pas une d√©fense universelle, surtout pour le DRM

#### Pi√®ge 3 : "J'analyse du malware, je peux tout faire"
**FAUX** ‚Äî L'analyse de malware est prot√©g√©e, mais pas sa redistribution ou son am√©lioration

#### Pi√®ge 4 : "C'est du fair use aux US"
**ATTENTION** ‚Äî Le fair use est une d√©fense, pas un droit. Il se d√©termine au cas par cas

### 5.5 Cours Complet : Cadre L√©gal du Reverse Engineering

#### 5.5.1 Les Textes Fondamentaux

**√âtats-Unis ‚Äî DMCA (1998)**
```
Section 1201(a) : Interdit le contournement de mesures techniques
Section 1201(f) : Exception pour l'interop√©rabilit√©
Section 1201(g) : Exception pour la recherche en s√©curit√©
Section 1201(j) : Exception pour les tests de s√©curit√©
```

**Union Europ√©enne ‚Äî Directive 2009/24/CE**
```
Article 5 : Exceptions pour interop√©rabilit√©
Article 6 : D√©compilation autoris√©e si :
  - N√©cessaire pour l'interop√©rabilit√©
  - Limit√©e aux parties n√©cessaires
  - Information non autrement disponible
  - Ne pas partager sauf interop√©rabilit√©
```

**France ‚Äî Code de la Propri√©t√© Intellectuelle**
```
Article L122-6-1 : Reprise de la directive EU
Article L335-3-1 : Sanctions pour contournement
```

#### 5.5.2 Les Cas Jurisprudentiels Majeurs

| Affaire | Ann√©e | Juridiction | D√©cision | Impact |
|---------|-------|-------------|----------|--------|
| Sega v. Accolade | 1992 | US | RE l√©gal | Interop√©rabilit√© prot√©g√©e |
| Sony v. Connectix | 2000 | US | RE l√©gal | √âmulation autoris√©e |
| Bowers v. Baystate | 2003 | US | EULA > Copyright | Controverse |
| Oracle v. Google | 2021 | US | APIs fair use | APIs non-prot√©geables |
| SAS v. WPL | 2012 | EU | Fonctionnalit√© non-prot√©g√©e | Limitation du copyright |

#### 5.5.3 Arbre de D√©cision L√©gale

```
Q1: Est-ce votre propre logiciel ?
‚îú‚îÄ‚îÄ OUI ‚Üí L√âGAL (propri√©t√©)
‚îî‚îÄ‚îÄ NON ‚Üí Q2

Q2: Analysez-vous du malware pour la s√©curit√© ?
‚îú‚îÄ‚îÄ OUI ‚Üí L√âGAL (dans la plupart des juridictions)
‚îî‚îÄ‚îÄ NON ‚Üí Q3

Q3: Le but est-il l'interop√©rabilit√© ?
‚îú‚îÄ‚îÄ OUI (et juridiction EU/US) ‚Üí Probablement L√âGAL
‚îî‚îÄ‚îÄ NON ‚Üí Q4

Q4: Le but est-il la recherche en s√©curit√© ?
‚îú‚îÄ‚îÄ OUI (et disclosure responsable) ‚Üí Probablement L√âGAL
‚îî‚îÄ‚îÄ NON ‚Üí Q5

Q5: Y a-t-il contournement de DRM ?
‚îú‚îÄ‚îÄ OUI ‚Üí Risque √âLEV√â (surtout US)
‚îî‚îÄ‚îÄ NON ‚Üí Q6

Q6: Usage commercial ?
‚îú‚îÄ‚îÄ OUI ‚Üí Risque √âLEV√â
‚îî‚îÄ‚îÄ NON ‚Üí GRAY ZONE (consulter un avocat)
```

### 5.6 Normes avec Explications

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ùå HORS NORME (probl√©matique l√©galement)                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ // Distribuer du code d√©compil√© sans restrictions               ‚îÇ
‚îÇ pub fn share_decompiled_code(code: &str) -> bool {              ‚îÇ
‚îÇ     upload_to_github(code)  // Distribution publique!           ‚îÇ
‚îÇ }                                                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚úÖ CONFORME                                                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ // Limiter l'usage aux fins autoris√©es                          ‚îÇ
‚îÇ pub fn use_decompiled_info(info: &str, purpose: Purpose) -> bool‚îÇ
‚îÇ {                                                               ‚îÇ
‚îÇ     match purpose {                                             ‚îÇ
‚îÇ         Purpose::Interoperability => true,                      ‚îÇ
‚îÇ         Purpose::SecurityResearch => true,                      ‚îÇ
‚îÇ         _ => false,  // Refuser autres usages                   ‚îÇ
‚îÇ     }                                                           ‚îÇ
‚îÇ }                                                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìñ POURQUOI ?                                                   ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ ‚Ä¢ Les exceptions l√©gales sont LIMIT√âES en scope                 ‚îÇ
‚îÇ ‚Ä¢ Distribution ‚â† Usage personnel                                ‚îÇ
‚îÇ ‚Ä¢ Documenter le but prot√®ge l√©galement                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.7 Simulation avec Trace d'Ex√©cution

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ √âtape ‚îÇ Analyse                            ‚îÇLegal   ‚îÇEthics  ‚îÇ Verdict Partiel     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   1   ‚îÇ Base score initialis√©              ‚îÇ   50   ‚îÇ   50   ‚îÇ GRAY_ZONE           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   2   ‚îÇ Target = proprietary_software      ‚îÇ   40   ‚îÇ   50   ‚îÇ GRAY_ZONE           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   3   ‚îÇ Action = decompile                 ‚îÇ   35   ‚îÇ   50   ‚îÇ GRAY_ZONE           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   4   ‚îÇ Purpose = interoperability         ‚îÇ   65   ‚îÇ   75   ‚îÇ GRAY_ZONE           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   5   ‚îÇ Jurisdiction = EU                  ‚îÇ   85   ‚îÇ   75   ‚îÇ LEGAL               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   6   ‚îÇ EULA forbids RE (ignor√© en EU)     ‚îÇ   85   ‚îÇ   75   ‚îÇ LEGAL               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   7   ‚îÇ No DRM, No commercial use          ‚îÇ   85   ‚îÇ   75   ‚îÇ LEGAL ‚úì             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.8 Mn√©motechniques

#### üé≠ MEME : "I'm Not a Lawyer But..." ‚Äî La d√©fense IANAL

Dans chaque thread Reddit sur le RE, quelqu'un √©crit "IANAL but I think it's fine..."

**Rappel :** IANAL (I Am Not A Lawyer). Si tu dois √©crire √ßa avant ton analyse, tu as BESOIN d'un vrai avocat.

```rust
fn should_proceed(scenario: &Scenario) -> bool {
    // Si tu te poses la question...
    if scenario.is_risky() {
        println!("IANAL - Consult a real lawyer!");
        return false;
    }
    true
}
```

---

#### üé¨ MEME : "We Have X at Home" ‚Äî Les alternatives l√©gales

Maman : "On a du reverse engineering √† la maison"
Le RE √† la maison : `strings binary | grep password`

**Point :** Avant de d√©compiler, v√©rifie si l'info est accessible autrement (documentation, APIs publiques, etc.)

---

#### üî• MEME : "This is Fine" ‚Äî Ignorer les red flags l√©gaux

Le d√©veloppeur : "EULA dit non, mais c'est pour un usage personnel, et je suis en EU, et c'est un peu pour l'interop√©rabilit√©, et..."

üî• Si tu dois empiler 5 justifications, ce n'est PAS fine.

---

#### üìú L'Acronyme "DISCO" pour la Compliance

```
D - Document ton but (pourquoi tu fais ce RE)
I - Interop√©rabilit√© ? V√©rifie les exceptions
S - Security research ? Disclosure responsable
C - Commercial use ? Attention maximale
O - Own software ? Pas de probl√®me
```

### 5.9 Applications Pratiques

| Sc√©nario R√©el | Analyse | Verdict |
|---------------|---------|---------|
| Analyser un ransomware pour cr√©er un d√©crypteur | Malware + Security = L√âGAL | ‚úÖ |
| D√©compiler Office pour faire un clone compatible | Interop + Commercial = RISQU√â | ‚ö†Ô∏è |
| Patcher un jeu solo pour ajouter des mods | Game + Personal = GRAY ZONE | ‚ö†Ô∏è |
| Cr√©er un keygen "pour tester" | Keygen + Any = ILL√âGAL | ‚ùå |
| RE de son propre firmware IoT | Own + Any = L√âGAL | ‚úÖ |
| Contourner Denuvo pour "archivage" | DRM Bypass = ILL√âGAL (US) | ‚ùå |

---

## ‚ö†Ô∏è SECTION 6 : PI√àGES ‚Äî R√âCAPITULATIF

| # | Pi√®ge | Erreur Commune | Solution |
|---|-------|----------------|----------|
| 1 | EULA = Loi | Croire qu'un EULA prime sur la loi | V√©rifier les exceptions l√©gales |
| 2 | Personal Use Shield | Croire que l'usage perso prot√®ge de tout | Non-d√©fense pour DRM |
| 3 | "C'est du malware" | Analyser puis distribuer des am√©liorations | Analyse ‚â† Distribution |
| 4 | Fair Use Automatique | Assumer fair use sans analyse 4 facteurs | Fair use = d√©fense, pas droit |
| 5 | EU = Paradise | Croire que tout est permis en EU | Exceptions ont des limites |
| 6 | Security = Carte Blanche | "Je fais de la s√©curit√©" sans responsible disclosure | Documenter et disclosure |

---

## üìù SECTION 7 : QCM

### Question 1
**En Union Europ√©enne, la d√©compilation pour interop√©rabilit√© est :**

A) Toujours ill√©gale
B) L√©gale uniquement avec autorisation √©crite
C) L√©gale sous conditions sp√©cifiques (Directive 2009/24/CE)
D) L√©gale uniquement pour les logiciels open source
E) Ill√©gale si un EULA l'interdit
F) L√©gale uniquement pour usage personnel
G) Soumise √† l'approbation d'un juge
H) L√©gale uniquement pour les gouvernements
I) D√©pend exclusivement du pays membre
J) Aucune de ces r√©ponses

**R√©ponse : C**

---

### Question 2
**Aux √âtats-Unis, la Section 1201(f) du DMCA permet :**

A) Le contournement de toute protection DRM
B) La d√©compilation pour n'importe quel but
C) Le reverse engineering pour l'interop√©rabilit√©
D) La cr√©ation de keygens
E) La distribution de code d√©compil√©
F) L'analyse de malware uniquement
G) Le piratage pour usage personnel
H) La copie de sauvegarde uniquement
I) Le modding de jeux vid√©o
J) La cr√©ation d'√©mulateurs uniquement

**R√©ponse : C**

---

### Question 3
**L'affaire Sega v. Accolade (1992) a √©tabli que :**

A) Le reverse engineering est toujours ill√©gal
B) Les EULAs ont force de loi
C) Le RE pour interop√©rabilit√© peut √™tre du fair use
D) Sega poss√®de tous les droits sur les consoles
E) Le code compil√© n'est pas prot√©g√©
F) Les √©mulateurs sont ill√©gaux
G) Seul le RE non-commercial est l√©gal
H) Le DMCA s'applique r√©troactivement
I) Les APIs sont prot√©geables
J) Le RE n√©cessite une licence

**R√©ponse : C**

---

### Question 4
**Quelle action est TOUJOURS l√©gale peu importe la juridiction ?**

A) D√©compiler un logiciel propri√©taire
B) Analyser du malware
C) Modifier un jeu vid√©o
D) Reverser son propre logiciel
E) Contourner un DRM
F) Cr√©er un √©mulateur
G) Patcher un logiciel commercial
H) Distribuer du code d√©compil√©
I) Cr√©er des outils de crack
J) Toutes ces r√©ponses

**R√©ponse : D**

---

### Question 5
**En France, l'article L122-6-1 du CPI :**

A) Interdit tout reverse engineering
B) Autorise le RE sans restriction
C) Transpose la Directive europ√©enne sur les logiciels
D) Ne s'applique qu'aux entreprises
E) Prot√®ge uniquement les logiciels fran√ßais
F) Est obsol√®te depuis 2020
G) Permet le contournement DRM
H) Interdit les d√©compilateurs
I) N'a jamais √©t√© appliqu√©
J) Contredit le droit europ√©en

**R√©ponse : C**

---

### Question 6
**La recherche en s√©curit√© informatique :**

A) Justifie toute forme de reverse engineering
B) B√©n√©ficie d'exemptions dans plusieurs juridictions
C) Est ill√©gale si elle trouve des vuln√©rabilit√©s
D) N√©cessite une autorisation gouvernementale
E) Est uniquement autoris√©e pour les universitaires
F) Permet la vente d'exploits
G) Interdit la publication des r√©sultats
H) N'est pas reconnue l√©galement
I) Requiert un contrat avec l'√©diteur
J) Est limit√©e aux logiciels open source

**R√©ponse : B**

---

### Question 7
**Un EULA interdisant le reverse engineering :**

A) Prime toujours sur la loi
B) Est automatiquement valide
C) Peut √™tre contourn√© par les exceptions l√©gales en EU
D) N'a aucune valeur l√©gale
E) S'applique uniquement aux entreprises
F) N√©cessite une signature manuscrite
G) Est ill√©gal en soi
H) S'applique m√™me apr√®s revente
I) Ne concerne que la d√©compilation
J) Est uniquement valide aux USA

**R√©ponse : C**

---

### Question 8
**Oracle v. Google (2021) a √©tabli que :**

A) Les APIs sont toujours prot√©geables
B) Google a viol√© le copyright d'Oracle
C) L'utilisation d'APIs peut √™tre du fair use
D) Java appartient √† Google
E) Les APIs ne peuvent jamais √™tre copi√©es
F) Le reverse engineering d'APIs est ill√©gal
G) Seules les APIs open source sont libres
H) Oracle doit ouvrir ses APIs
I) Android est ill√©gal
J) Le code source est toujours prot√©g√©

**R√©ponse : C**

---

### Question 9
**La cr√©ation d'un keygen pour un logiciel commercial est :**

A) L√©gale pour usage personnel
B) L√©gale si non distribu√©e
C) Ill√©gale dans la plupart des juridictions
D) L√©gale en Union Europ√©enne
E) Une forme de fair use
F) Autoris√©e pour la recherche
G) L√©gale si le logiciel est abandonn√©
H) Prot√©g√©e par la libert√© d'expression
I) L√©gale avec une licence √©ducative
J) Autoris√©e pour les tests de s√©curit√©

**R√©ponse : C**

---

### Question 10
**Le "responsible disclosure" en s√©curit√© implique :**

A) Ne jamais publier de vuln√©rabilit√©s
B) Vendre les vuln√©rabilit√©s au plus offrant
C) Notifier le vendeur avant publication publique
D) Publier imm√©diatement toutes les failles
E) Garder les failles secr√®tes ind√©finiment
F) Signaler uniquement aux gouvernements
G) Attendre une r√©compense avant notification
H) Publier anonymement
I) Ne concerner que les failles critiques
J) √ätre obligatoire l√©galement partout

**R√©ponse : C**

---

## üìä SECTION 8 : R√âCAPITULATIF

| Aspect | D√©tail |
|--------|--------|
| **Concept cl√©** | √âvaluation √©thique et l√©gale du reverse engineering |
| **Difficult√©** | 6/10 - Concepts juridiques complexes |
| **Comp√©tences acquises** | Cadre l√©gal international, √©valuation de risques, √©thique |
| **Pi√®ges principaux** | EULA ‚â† Loi, Fair Use non automatique, Juridiction matters |
| **Applications** | Compliance, recherche s√©curit√©, d√©veloppement l√©gal |

---

## üì¶ SECTION 9 : DEPLOYMENT PACK

```json
{
  "deploy": {
    "hackbrain_version": "5.5.2",
    "engine_version": "v22.1",
    "exercise_slug": "3.5.4-a-ethics-guardian",
    "generated_at": "2026-01-12 02:30:00",

    "metadata": {
      "exercise_id": "3.5.4-a",
      "exercise_name": "ethics_guardian",
      "module": "3.5",
      "module_name": "Reverse Engineering",
      "concept": "a",
      "concept_name": "√âthique et Cadre L√©gal",
      "type": "cours_qcm",
      "tier": 1,
      "tier_info": "Concept isol√©",
      "phase": 3,
      "difficulty": 6,
      "difficulty_stars": "‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ",
      "language": "rust",
      "duration_minutes": 90,
      "xp_base": 300,
      "xp_bonus_multiplier": 2,
      "bonus_tier": "STANDARD",
      "bonus_icon": "‚ö°",
      "complexity_time": "T1 O(1)",
      "complexity_space": "S1 O(1)",
      "prerequisites": ["3.5.1-a", "3.5.2-a", "3.5.3-a"],
      "domains": ["Crypto", "FS", "Process"],
      "tags": ["ethics", "legal", "reverse-engineering", "compliance"],
      "meme_reference": "IANAL / This is Fine / We Have X at Home"
    }
  }
}
```

---

*Exercice 3.5.4-a ‚Äî Ethics Guardian*
*"The law is not about what you can get away with, it's about what's right."*
*HACKBRAIN v5.5.2 ‚Äî L'excellence p√©dagogique ne se n√©gocie pas*
